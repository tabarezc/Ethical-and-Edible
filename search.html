<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
    
<head>
    <link rel="stylesheet" href="modal.css" />
    <link rel="stylesheet" href="search.css" />
    <meta charset="utf-8" />
    <title>Ethical and Edible</title>
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>

</head>
<body>

    <!--Navigation bar-->
<nav class="navbar navbar-expand-lg navbar-light">
            <a class="navbar-brand" href="#">Explore</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown"
                aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="Home.html">Home <span
                                class="sr-only"></span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="addRecipeIngredient.html">Build a Meal <span
                                class="sr-only"></span></a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Cuisines
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                            <a class="dropdown-item" href="#">American</a>
                            <a class="dropdown-item" href="#">Asian</a>
                            <a class="dropdown-item" href="#">Mexican</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Diets
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                            <a class="dropdown-item" href="#">Ketogenic</a>
                            <a class="dropdown-item" href="#">Vegetarian</a>
                            <a class="dropdown-item" href="#">Paleo</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Ingredients
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                            <a class="dropdown-item" href="#">Avocado</a>
                            <a class="dropdown-item" href="#">Bacon</a>
                            <a class="dropdown-item" href="#">Beef</a>
                        </div>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="Login.html">Log in</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="CreateAccount.html">Register</a>
                    </li>
                </ul>
            </div>
        </nav>
<!--end of Navigation bar-->
 

<h2>Search Menu</h2>
<p>Search for a recipe and press enter.</p>
    <div class="row">
    <div class="left" style="background-color:#bbb;">
        <h2>Menu</h2>
        <input type="search" id="mySearch" placeholder="Search.." title="Type in a category">
        
        
        
    </div>
    
<div class="right" style="background-color:#ddd;">
    <ul id="myMenu">
        <h1 id="recipeName"></h1>
            <div class="ingredientlist">
                <h2 class="ingredientlist">Ingredients: <span style="font-size: 15px">(click an ingredient to view ethical information)</span></h2>
                <ul id="myingredients" ></ul>
            </div>
    </ul>
    </div>
    </div>
    <div align="center">
        <div><button onclick="location.href='recipeLibrary.html'">Save to Recipe Library</button></div>
    </div>

<script>

    /*function myFunction() {
        var input, filter, ul, li, a, i;
        input = document.getElementById("mySearch");
        filter = input.value.toUpperCase();
        ul = document.getElementById("myMenu");
        li = ul.getElementsByTagName("li");
        for (i = 0; i < li.length; i++) {
            a = li[i].getElementsByTagName("a")[0];
            if (a.innerHTML.toUpperCase().indexOf(filter) > -1) {
                li[i].style.display = "";
            } else {
                li[i].style.display = "none";
            }
        }
    }*/

    //TESTING CODE
    /*document.addEventListener('DOMContentLoaded', bindButtons);

    function bindButtons(){
        document.getElementById('mySearch').addEventListener('search', function(event){
          var req = new XMLHttpRequest();
          //var payload = {longUrl:null};
          //payload.longUrl = document.getElementById('recipeName').value;
          req.open('GET', 'test.json', true);
          //req.setRequestHeader('Content-Type', 'application/json');
          //req.send(JSON.stringify(payload));
          var response = JSON.parse(req.responseText);
          document.getElementById('demo').textContent = response;
          event.preventDefault();
        })
      }*/

    document.addEventListener('DOMContentLoaded', bindButtons);

    function bindButtons(){
        document.getElementById('mySearch').addEventListener('search', function(event){
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                var myArr = JSON.parse(this.responseText);
                //get # of items in array
                var count = myArr.Recipes.length;
                //document.getElementById("count").innerHTML = count;
                input = document.getElementById("mySearch");
                searchName = input.value.toUpperCase();
                for(var i = 0; i < count; i++){
                    if( searchName == myArr.Recipes[i].name.toUpperCase()){
                        //make sure list of ingredients is cleared from previous searches
                        $('#myingredients').empty(); 
                        //to show found recipe names
                        document.getElementById("recipeName").innerHTML = myArr.Recipes[i].name;
                        //to populate ingredients list for found recipe
                        var ingredients = myArr.Recipes[i].ingredients;
                        var ul = document.getElementById("myingredients");
                        for (var j = 0; j < ingredients.length; j++){
                            var ingredient = ingredients[j];
                            //Creates new list node for every ingredient
                            var listItem = document.createElement("li");
                            //Adds the ingredient name as the text content of the list node
                            listItem.textContent = ingredient;
                            ul.appendChild(listItem);
                        }
                        break;
                    //If the search bar is empty
                    }else if (searchName == "" ){
                        document.getElementById("recipeName").innerHTML = "";
                        $('#myingredients').empty();
                    //If nothing is found
                    } else{
                        document.getElementById("recipeName").innerHTML = "no matching results";
                        //make sure list of ingredients is cleared from previous searches
                        $('#myingredients').empty();
                    }
                }
            }
        };
        xmlhttp.open("GET", "recipes.json", true);
        xmlhttp.send();
        event.preventDefault();
        })
    }



</script>
<script src="modal.js"></script>
</body>
</html>